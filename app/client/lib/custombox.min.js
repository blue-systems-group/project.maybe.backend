/*
 *  custombox v2.2.5 - 2015-02-01
 *  Modal Window Effects with transitions CSS3.
 *  http://dixso.github.io/custombox/
 *  (c) 2015 Julio de la Calle - @dixso9
 *
 *  Under MIT License - http://opensource.org/licenses/MIT
 */

Custombox=function(a,b,c){"use strict";var d={create:document.createElement,settings:[],overlay:[],wrapper:[],container:[],modal:[],content:[],inline:[],size:[],close:[],open:[],scroll:[],display:[],item:-1},e={target:null,id:null,cache:!1,escKey:!0,zIndex:"auto",overlay:!0,overlayColor:"#000",overlayOpacity:.8,overlayClose:!0,overlaySpeed:300,overlayEffect:"auto",width:null,effect:"fadein",position:"center, center",animation:null,speed:500,open:null,complete:null,close:null},f={oldIE:navigator.appVersion.indexOf("MSIE 8.")>-1||navigator.appVersion.indexOf("MSIE 9.")>-1,oldMobile:/(iPhone|iPad|iPod)\sOS\s6/.test(navigator.userAgent),overlay:{perspective:["letmein","makeway","slip"],together:["corner","slidetogether","scale","door","push","contentscale","simplegenie","slit","slip"]},modal:{position:["slide","flip","rotate"]}},g={init:function(){this.merge().built().check().binds()},merge:function(){return d.settings.push(h.extend({},e,d.options)),delete d.options,d.item=d.settings.length-1,"auto"===d.settings[d.item].overlayEffect&&(d.settings[d.item].overlayEffect=d.settings[d.item].effect),this},built:function(){var e=h.zIndex();if(c.classList.add("custombox-open"),c.classList.add("custombox-open-"+d.settings[d.item].overlayEffect),f.overlay.perspective.indexOf(d.settings[d.item].overlayEffect)>-1&&(d.scroll.push(c&&c.scrollTop||b.body&&b.body.scrollTop||0),c.classList.add("custombox-perspective"),a.scrollTo(0,0)),!d.item){for(d.main=d.create.call(b,"div");b.body.firstChild;)d.main.appendChild(b.body.firstChild);b.body.appendChild(d.main)}return"push"===d.settings[d.item].overlayEffect&&(d.main.style.transitionDuration=d.settings[d.item].speed+"ms"),d.main.classList.add("custombox-container"),d.main.classList.add("custombox-container-"+d.settings[d.item].overlayEffect),d.settings[d.item].overlay?(d.overlay.push(d.create.call(b,"div")),d.overlay[d.item].classList.add("custombox-overlay"),d.overlay[d.item].classList.add("custombox-overlay-"+d.settings[d.item].overlayEffect),d.overlay[d.item].style.zIndex=e+2,d.overlay[d.item].style.backgroundColor=d.settings[d.item].overlayColor,d.overlay[d.item].dataset.custombox=d.settings[d.item].id,f.overlay.perspective.indexOf(d.settings[d.item].overlayEffect)>-1||f.overlay.together.indexOf(d.settings[d.item].overlayEffect)>-1?d.overlay[d.item].style.opacity=d.settings[d.item].overlayOpacity:d.overlay[d.item].classList.add("custombox-overlay-default"),d.overlay[d.item].style.transitionDuration=f.overlay.together.indexOf(d.settings[d.item].overlayEffect)>-1?d.settings[d.item].speed+"ms":d.settings[d.item].overlaySpeed+"ms",b.body.insertBefore(d.overlay[d.item],b.body.lastChild.nextSibling)):d.overlay.push(null),d.wrapper.push(d.create.call(b,"div")),d.wrapper[d.item].classList.add("custombox-modal-wrapper"),d.wrapper[d.item].classList.add("custombox-modal-wrapper-"+d.settings[d.item].effect),d.wrapper[d.item].style.zIndex=e+3,d.wrapper[d.item].dataset.custombox=d.settings[d.item].id,b.body.insertBefore(d.wrapper[d.item],b.body.lastChild.nextSibling),d.container.push(d.create.call(b,"div")),d.container[d.item].classList.add("custombox-modal-container"),d.container[d.item].classList.add("custombox-modal-container-"+d.settings[d.item].effect),d.container[d.item].style.zIndex=e+4,f.modal.position.indexOf(d.settings[d.item].effect)>-1&&(d.settings[d.item].animation=null!==d.settings[d.item].animation?d.settings[d.item].animation.indexOf(",")>-1?d.settings[d.item].animation.split(","):[d.settings[d.item].animation]:"slide"===d.settings[d.item].effect?["top"]:"flip"===d.settings[d.item].effect?["horizontal"]:["bottom"]),d.modal.push(d.create.call(b,"div")),d.modal[d.item].classList.add("custombox-modal"),d.modal[d.item].classList.add("custombox-modal-"+d.settings[d.item].effect+(f.modal.position.indexOf(d.settings[d.item].effect)>-1?"-"+d.settings[d.item].animation[0].trim():"")),d.modal[d.item].style.transitionDuration=d.settings[d.item].speed+"ms",d.modal[d.item].style.zIndex=e+4,d.wrapper[d.item].appendChild(d.container[d.item]).appendChild(d.modal[d.item]),this},check:function(){if("function"==typeof d.settings[d.item].open&&d.settings[d.item].open.call(),b.createEvent){var a=b.createEvent("Event");a.initEvent("custombox.open",!0,!0),b.dispatchEvent(a)}return d.settings[d.item].position.indexOf(",")>-1?(d.settings[d.item].position=d.settings[d.item].position.split(","),"#"===d.settings[d.item].target.charAt(0)||"."===d.settings[d.item].target.charAt(0)&&"/"!==d.settings[d.item].target.charAt(1)?b.querySelector(d.settings[d.item].target)?(d.inline.push(d.create.call(b,"div")),d.content.push(b.querySelector(d.settings[d.item].target)),d.display.push("none"===d.content[d.item].style.display),d.content[d.item].style.display="block",d.content[d.item].parentNode.insertBefore(d.inline[d.item],d.content[d.item]),this.size().open()):this.error():this.ajax()):this.error(),this},ajax:function(){var a=this,c=new XMLHttpRequest,e=d.create.call(b,"div");c.onreadystatechange=function(){4===c.readyState&&(200===c.status?(e.innerHTML=c.responseText,d.content.push(e),d.content[d.item].style.display="block",f.oldIE?d.content[d.item].style.styleFloat="left":d.content[d.item].style.cssFloat="left",d.container[d.item].appendChild(d.content[d.item]),a.size().open()):a.error())},c.open("GET",d.settings[d.item].target+(d.settings[d.item].cache?"":(/[?].+=/.test(d.settings[d.item].target)?"&_=":"?_=")+Date.now()),!0),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.send(null)},size:function(){f.oldIE&&(a.innerHeight=c.clientHeight);var b=d.content[d.item].offsetWidth;if(d.inline[d.item]||(f.oldIE?d.content[d.item].style.styleFloat="none":d.content[d.item].style.cssFloat="none"),isNaN(d.settings[d.item].width)||null===d.settings[d.item].width||(b=parseInt(d.settings[d.item].width,0)),d.size.push(b),d.size[d.item]+60>=a.innerWidth){d.container[d.item].style.width="auto",d.container[d.item].style.margin="5%",d.wrapper[d.item].style.width=a.innerWidth+"px";for(var e=0,g=d.content[d.item].querySelectorAll(":scope > *"),h=g.length;h>e;e++)g[e].offsetWidth>a.innerWidth&&(g[e].style.width="auto")}else{switch(d.settings[d.item].position[0].trim()){case"left":d.container[d.item].style.marginLeft=0;break;case"right":d.container[d.item].style.marginRight=0}d.container[d.item].style.width=d.size[d.item]+"px"}if(d.content[d.item].style.width="auto",d.modal[d.item].appendChild(d.content[d.item]),d.content[d.item].offsetHeight>=a.innerHeight)d.container[d.item].style.marginTop="5%",d.container[d.item].style.marginBottom="5%";else{var i;switch(d.settings[d.item].position[1].trim()){case"top":i=0;break;case"bottom":i=a.innerHeight-d.content[d.item].offsetHeight+"px";break;default:i=a.innerHeight/2-d.content[d.item].offsetHeight/2+"px"}d.container[d.item].style.marginTop=i}return this},open:function(){if(d.settings[d.item].overlay)if(f.overlay.perspective.indexOf(d.settings[d.item].overlayEffect)>-1||f.overlay.together.indexOf(d.settings[d.item].overlayEffect)>-1?d.overlay[d.item].classList.add("custombox-overlay-open"):d.overlay[d.item].style.opacity=d.settings[d.item].overlayOpacity,d.main.classList.add("custombox-container-open"),f.overlay.together.indexOf(d.settings[d.item].overlayEffect)>-1||f.oldIE)d.wrapper[d.item].classList.add("custombox-modal-open");else{var a=function(){d.overlay[d.item].removeEventListener("transitionend",a),d.wrapper[d.item].classList.add("custombox-modal-open")};d.overlay[d.item].addEventListener("transitionend",a,!1)}else d.wrapper[d.item].classList.add("custombox-modal-open"),d.main.classList.add("custombox-container-open");return this},binds:function(){var c=this;d.settings[d.item].escKey&&(b.onkeydown=function(b){b=b||a.event,27===b.keyCode&&c.close()}),d.settings[d.item].overlayClose&&d.wrapper[d.item].addEventListener("click",function(a){a.target===d.wrapper[d.item]&&c.close()},!1),a.addEventListener("onorientationchange"in a?"orientationchange":"resize",function(){c.responsive()},!1);var e=function(){if(!d.inline[d.item])for(var a=0,c=d.modal[d.item].getElementsByTagName("script"),e=c.length;e>a;a++)new Function(c[a].text)();if(d.settings[d.item]&&"function"==typeof d.settings[d.item].complete&&d.settings[d.item].complete.call(),b.createEvent){var f=b.createEvent("Event");f.initEvent("custombox.complete",!0,!0),b.dispatchEvent(f)}},g=function(){e(),d.modal[d.item].removeEventListener("transitionend",g)};f.oldIE||f.oldMobile?setTimeout(function(){e()},d.settings[d.item].overlaySpeed):"slit"!==d.settings[d.item].effect?d.modal[d.item].addEventListener("transitionend",g,!1):d.modal[d.item].addEventListener("animationend",g,!1)},close:function(e){var g;if("first"===e)g=0;else if("undefined"!=typeof e){for(var h=0,i=d.settings.length;i>h;h++)if(d.settings[h].id==e){g=h;break}void 0===g&&(g=d.settings.length-1)}else g=d.settings.length-1;var j=function(){if(c.classList.remove("custombox-open-"+d.settings[g].overlayEffect),d.settings[g].overlay&&(d.overlay[g].classList.add("custombox-overlay-close"),d.overlay[g].style.opacity&&(d.overlay[g].style.opacity=0),d.overlay[g].classList.remove("custombox-overlay-open"),d.main.classList.remove("custombox-container-open")),f.oldIE||f.oldMobile||!d.overlay[g])k();else{var a=function(){d.overlay[g].removeEventListener("transitionend",a),k()};d.overlay[g].addEventListener("transitionend",a,!1)}},k=function(){if(1===d.settings.length&&(c.classList.remove("custombox-perspective"),c.classList.remove("custombox-open"),"undefined"!=typeof d.scroll[g]&&a.scrollTo(0,d.scroll[g])),c.classList.remove("custombox-open-"+d.settings[g].overlayEffect),d.inline[g]&&(f.oldIE?(d.content[g].style.removeAttribute("width"),d.content[g].style.removeAttribute("display")):(d.content[g].style.removeProperty("width"),d.content[g].style.removeProperty("display")),d.display[g]&&(d.content[g].style.display="none"),d.inline[g].parentNode.replaceChild(d.content[g],d.inline[g])),d.main.classList.remove("custombox-container-"+d.settings[g].overlayEffect),d.wrapper[g].parentNode.removeChild(d.wrapper[g]),d.settings[g].overlay&&d.overlay[g].parentNode.removeChild(d.overlay[g]),"function"==typeof d.settings[g].close&&d.settings[g].close.call(),b.createEvent){var e=b.createEvent("Event");e.initEvent("custombox.close",!0,!0),b.dispatchEvent(e)}if(1===d.settings.length){for(var h=b.querySelectorAll(".custombox-container > *"),i=0,j=h.length;j>i;i++)document.body.insertBefore(h[i],d.main);d.main.parentNode&&d.main.parentNode.removeChild(d.main)}d.wrapper.splice(g,1),d.inline[g]&&d.inline.splice(g,1),d.content.splice(g,1),d.container.splice(g,1),d.modal.splice(g,1),d.overlay.splice(g,1),d.size.splice(g,1),d.settings.splice(g,1),d.scroll.splice(g,1)};if(f.modal.position.indexOf(d.settings[g].effect)>-1&&d.settings[g].animation.length>1&&(d.modal[g].classList.remove("custombox-modal-"+d.settings[g].effect+"-"+d.settings[g].animation[0]),d.modal[g].classList.add("custombox-modal-"+d.settings[g].effect+"-"+d.settings[g].animation[1].trim())),d.wrapper[g].classList.remove("custombox-modal-open"),f.oldIE||f.oldMobile||f.overlay.together.indexOf(d.settings[g].overlayEffect)>-1)j();else{var l=function(){d.wrapper[g].removeEventListener("transitionend",l),j()};d.wrapper[g].addEventListener("transitionend",l,!1)}},responsive:function(){f.oldIE&&(a.innerHeight=c.clientHeight);for(var b,e=0,g=d.container.length;g>e;e++){if(d.size[e]+60>=a.innerWidth)d.container[e].style.width="auto",d.container[e].style.marginLeft="5%",d.container[e].style.marginRight="5%",d.wrapper[d.item].style.width=a.innerWidth+"px";else{switch(d.settings[d.item].position[0].trim()){case"left":d.container[e].style.marginLeft=0;break;case"right":d.container[e].style.marginRight=0;break;default:d.container[e].style.marginLeft="auto",d.container[e].style.marginRight="auto"}d.container[e].style.width=d.size[e]+"px",d.wrapper[d.item].style.width="auto"}if(d.content[e].offsetHeight>=a.innerHeight)d.container[e].style.marginTop="5%",d.container[e].style.marginBottom="5%";else{switch(d.settings[d.item].position[1]){case"top":b=0;break;case"bottom":b=a.innerHeight-d.content[e].offsetHeight+"px";break;default:b=a.innerHeight/2-d.content[e].offsetHeight/2+"px"}d.container[e].style.marginTop=b}}},error:function(){alert("Error to load this target: "+d.settings[d.item].target)}},h={zIndex:function(){var b=0;if(isNaN(d.settings[d.item].zIndex))for(var c=0,e=document.getElementsByTagName("*"),f=e.length;f>c;c+=1){var g=a.getComputedStyle(e[c]).getPropertyValue("z-index");g&&(g=+g,g>b&&(b=g))}else b=d.settings[d.item].zIndex;return b},extend:function(){for(var a=1,b=arguments.length;b>a;a++)for(var c in arguments[a])arguments[a].hasOwnProperty(c)&&(arguments[0][c]=arguments[a][c]);return arguments[0]}};return{open:function(a){d.options=a,g.init()},close:function(a){g.close(a)}}}(window,document,document.documentElement);